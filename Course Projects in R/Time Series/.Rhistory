acf(v1, 20, na.action = na.pass)
acf(v1, lag.max = 20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
acf(vb,20, na.action = na.pass)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, na.acton = na.pass, lag.max = 20)
acf(v2, lag.max = 20, na.action = na.pass)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
acf(v2, lag.max = 20, na.action = na.pass)
### n = 50
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 30, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
acf(vb,20, na.action = na.pass)
### n = 50
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
acf(vb,20, na.action = na.pass)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
## Moving average when n = 500
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
### n = 50
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
wa=rnorm(502,0,1)
wb=rnorm(52,0,1)
va=filter(wa, sides=2, rep(1,3)/3)
vb=filter(wb, sides=2, rep(1,3)/3)
par(mfrow=c(2,1))
acf(va,20, na.action = na.pass)
acf(vb,20, na.action = na.pass)
set.seed(250)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
set.seed(250)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
set.seed(250)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
set.seed(250)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
## Moving average when n = 500
set.seed(250)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
### n = 50
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
et.seed(250)
set.seed(250)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
### n = 50
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
### n = 50
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
### n = 50
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
### n = 50
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
## Moving average when n = 500
set.seed(1101)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
### n = 50
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
## Moving average when n = 500
set.seed(1101)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
### n = 50
set.seed(250)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
acf(v1, lag.max = 20, na.action = na.pass)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
set.seed(1101)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
set.seed(1101)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
set.seed(1101)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
##### HW2_Problem 1.21
## Moving average when n = 500
set.seed(10085)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
#par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
print(acf(v1, lag.max = 20, na.action = na.pass))
### n = 50
set.seed(10086)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
print(acf(v2, lag.max = 20, na.action = na.pass))
set.seed(1101)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
## Moving average when n = 500
set.seed(2001)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
print(acf(v1, lag.max = 20, na.action = na.pass))
## Moving average when n = 500
set.seed(2001)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
### n = 50
set.seed(2001)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
## Moving average when n = 500
set.seed(2001)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
acf(v1, lag.max = 20, na.action = na.pass)
### n = 50
set.seed(2001)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(1,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
acf(v2, lag.max = 20, na.action = na.pass)
print(acf(v1, lag.max = 20, na.action = na.pass))
print(acf(v2, lag.max = 20, na.action = na.pass))
print(acf(v1, lag.max = 20, na.action = na.pass))
acf(v2, lag.max = 20, na.action = na.pass)
print(acf(v2, lag.max = 20, na.action = na.pass))
## Moving average when n = 500
set.seed(2001)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
print(acf(v1, lag.max = 20, na.action = na.pass))
### n = 50
set.seed(2001)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
print(acf(v2, lag.max = 20, na.action = na.pass))
## Moving average when n = 500
set.seed(2001)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
print(acf(v1, lag.max = 20, na.action = na.pass))
## Moving average when n = 500
set.seed(2001)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
print(acf(v1, lag.max = 20, na.action = na.pass))
### n = 50
set.seed(2001)
w2 = rnorm (50, 0, 1)
v2 = filter(w2, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w2, main = "white noise2")
plot.ts(v2, ylim = c(-3,3), main = "moving average2")
print(acf(v2, lag.max = 20, na.action = na.pass))
## Moving average when n = 500
set.seed(2001)
w1 = rnorm(500, 0, 1)
v1 = filter(w1, sides = 2, filter = rep(1/3, 3))
par(mfrow = c(3,1))
plot.ts(w1, main = "white noise")
plot.ts(v1,ylim = c(-3,3), main = "moving average")
print(acf(v1, lag.max = 20, na.action = na.pass))
libarary(astsa)
###3.10
library(astsa)
library(forecast)
data = cmort
###3.10
library(astsa)
###3.10
library(astsa)
library(forecast)
data = cmort
###### raw data #####
load("~/Desktop/137 Final/finalproject.Rdata")
data <- finalPro_data[c(3,8)]
data <- ts(data$Exports, start = 1960, end = 2017, frequency = 1)
plot.ts(data, type="o",main = "Original Data", ylab = "CAR Exports")
### Non-stationary
#acf(data, main=" ACF of Original data")
#pacf(data, main = "PACF of Original Data")
#### Difference MA3, AR2#########
plot.ts(diff(data), type="o",main = "Difference", ylab = "CAR Exports")
acf(diff(data))
pacf(diff(data))
sarima(diff(data),0,0,3)
sarima(diff(data),0,0,3)
plot.ts(log.diff,main = "Log Difference", ylab = "CAR Exports")
log.exports = log(data)
plot.ts (log.exports) ## similar
acf(log.exports)
pacf(log.exports)
log.exports = log(data)
plot.ts (log.exports) ## similar
acf(log.exports)
pacf(log.exports)
### Log
```{r}
```{r}
library(MASS)
library(forecast)
library(forecast)
###### raw data #####
load("~/Desktop/137 Final/finalproject.Rdata")
data <- finalPro_data[c(3,8)]
data <- ts(data$Exports, start = 1960, end = 2017, frequency = 1)
plot.ts(data, type="o",main = "Original Data", ylab = "CAR Exports")
### Non-stationary
#acf(data, main=" ACF of Original data")
#pacf(data, main = "PACF of Original Data")
```
```{r}
#### Difference MA3, AR2#########
plot.ts(diff(data), type="o",main = "Difference", ylab = "CAR Exports")
acf(diff(data))
pacf(diff(data))
sarima(diff(data),0,0,3)
sarima(diff(data),2,0,0)
### Log
```{r}
plot.ts(log.diff,main = "Log Difference", ylab = "CAR Exports")
library(astsa)
library(forecast)
library(MASS)
library(astsa)
library(forecast)
library(MASS)
```{r}
setwd("/Users/mqh/Desktop/STA 137/Project/")
load("finalproject.Rdata")
data <- finalPro_data[c(3,8)]
data <- ts(data$Exports, start = 1960, end = 2017, frequency = 1)
data <- finalPro_data[c(3,8)]
data <- ts(data$Exports, start = 1960, end = 2017, frequency = 1)
library(MASS)
library(forecast)
###### raw data #####
load("~/Desktop/137 Final/finalproject.Rdata")
data <- finalPro_data[c(3,8)]
data <- ts(data$Exports, start = 1960, end = 2017, frequency = 1)
plot.ts(data, type="o",main = "Original Data", ylab = "CAR Exports")
#### Difference MA3, AR2#########
plot.ts(diff(data), type="o",main = "Difference", ylab = "CAR Exports")
acf(diff(data))
pacf(diff(data))
sarima(diff(data),0,0,3)
sarima(diff(data),2,0,0)
log.exports = log(data)
plot.ts (log.exports) ## similar
acf(log.exports)
pacf(log.exports)
log.diff = diff(log.exports)
plot.ts(log.diff,main = "Log Difference", ylab = "CAR Exports")
acf(log.diff)
pacf(log.diff)
sarima(log.diff, 0,0,3)
sarima(log.diff, 2,0,0)
sarima(log.diff, 2,0,0, no.constant = TRUE)
sarima(log.diff, 2,0,0)
